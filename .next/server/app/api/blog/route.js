"use strict";(()=>{var e={};e.id=342,e.ids=[342],e.modules={1185:e=>{e.exports=require("mongoose")},399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},7147:e=>{e.exports=require("fs")},2805:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>q,patchFetch:()=>S,requestAsyncStorage:()=>b,routeModule:()=>h,serverHooks:()=>x,staticGenerationAsyncStorage:()=>v});var a={};r.r(a),r.d(a,{DELETE:()=>w,GET:()=>f,POST:()=>y});var o=r(9303),i=r(8716),n=r(670),s=r(3473),u=r(1185),d=r.n(u);let g=new(d()).Schema({title:{type:String,required:!0},description:{type:String,required:!0},category:{type:String,required:!0},author:{type:String,required:!0},image:{type:String,required:!0},authorImg:{type:String,required:!0},date:{type:Date,default:Date.now()}}),l=d().models.blog||d().model("blog",g),p=require("fs/promises"),{NextResponse:c}=r(7070),m=r(7147);async function f(e){let t=e.nextUrl.searchParams.get("id");if(t){let e=await l.findById(t);return c.json(e)}{let e=await l.find({});return c.json({blogs:e})}}async function y(e){let t=await e.formData(),r=Date.now(),a=t.get("image"),o=await a.arrayBuffer(),i=Buffer.from(o),n=`./public/${r}_${a.name}`;await (0,p.writeFile)(n,i);let s=`/${r}_${a.name}`,u={title:`${t.get("title")}`,description:`${t.get("description")}`,category:`${t.get("category")}`,author:`${t.get("author")}`,image:`${s}`,authorImg:`${t.get("authorImg")}`};return await l.create(u),console.log("Blog Saved"),c.json({success:!0,msg:"Blog Added"})}async function w(e){let t=await e.nextUrl.searchParams.get("id"),r=await l.findById(t);return m.unlink(`./public${r.image}`,()=>{}),await l.findByIdAndDelete(t),c.json({msg:"Blog Deleted"})}(async()=>{await (0,s.u)()})();let h=new o.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/blog/route",pathname:"/api/blog",filename:"route",bundlePath:"app/api/blog/route"},resolvedPagePath:"D:\\Projects\\next-blog-app\\app\\api\\blog\\route.js",nextConfigOutput:"",userland:a}),{requestAsyncStorage:b,staticGenerationAsyncStorage:v,serverHooks:x}=h,q="/api/blog/route";function S(){return(0,n.patchFetch)({serverHooks:x,staticGenerationAsyncStorage:v})}},3473:(e,t,r)=>{r.d(t,{u:()=>i});var a=r(1185),o=r.n(a);let i=async()=>{await o().connect("mongodb+srv://pvs:pvs1212@cluster0.glwgm.mongodb.net/"),console.log("DB Connected!")}}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[948,972],()=>r(2805));module.exports=a})();